# PAL: Program-aided Language Models

**핵심 요약:**  
프로그램 보조 언어 모델(PAL)은 자연어 문제를 단계별로 해석해 중간 단계로 파이썬 코드를 생성하고, 계산·해결은 외부 인터프리터에 위임함으로써 기존 체인오브썰트(COT) 방식이 지닌 연산 오류 문제를 근본적으로 해소한다.[1]

***

## 1. 해결하고자 하는 문제  
기존 대형 언어 모델(LLM)의 체인오브썰트(COT) 기반 추론은  
- 복잡한 산술 연산에서 자주 계산 오류를 범하고  
- 문제 해석 단계가 올바르더라도 최종 결과가 부정확해지는 한계  
가 있다.[1]

## 2. 제안하는 방법  
PAL은 두 가지 핵심 요소로 구성된다:[1]

  1. **프롬프트 구성:**  
     - 자연어 문제를 설명하는 주석(comment)과,  
     - 문제를 푸는 절차를 담은 파이썬 코드  
     가 인터리브(interleave)된 형태로 프롬프트를 작성  
     
  2. **외부 인터프리터 활용:**  
     - LLM이 생성한 코드 블록을 실제 파이썬 런타임에서 실행해  
     - 계산·논리적 해결을 100% 정확하게 수행  
     
수식적 표현 예시:  

$$ \text{answer} = a - b \times c $$  

위 식을 LLM이 코드(`answer = a - b * c`)로 생성하고, 인터프리터가 실행해 정확한 답을 도출.

## 3. 모델 구조 및 작동 흐름  
1. 프롬프트에 3~6개의 예제 ⟨문제 · (주석+코드)⟩를 포함  
2. 테스트 문제를 입력하면 LLM이 코드 기반 추론(chain-of-thought)인 ‘생각(thought)’을 생성  
3. 생성된 코드를 파이썬 인터프리터로 실행하여 최종 답 도출  
4. (Optional) 다중 샘플링(n=40) 시, 과반수 투표(self‐consistency)로 정확도 추가 향상  

## 4. 성능 향상  
- **수학 문제(GSM8K):** COT 대비 절대 6.4% 포인트 향상, 최고 72.0% → 샘플링 40회 시 80.4%[1]
- **대형 숫자 문제(GSM-HARD):** COT 23.1% → PAL 61.2%로 38.1% 포인트 대폭 상승[1]
- **상징적·알고리즘 문제:** “Colored Objects” 86.3% → 95.1%, “Repeat Copy” 68.8% → 90.6% 등 종합적 정확도 대폭 개선[1]

## 5. 한계 및 고찰  
- **프롬프트 설계 의존성:** 의미 있는 변수명과 주석이 정확도에 큰 영향을 미침[1]
- **LLM 코드 생성 능력 필요:** 코드 모델(코덱스)에서 최상의 성능, 자연어 모델에서는 모델 역량에 따라 성능 편차 발생  
- **실행 환경 제약:** 외부 인터프리터 사용이 필수이며, 실시간 응답성이 떨어질 수 있음  

## 6. 일반화 및 확장 가능성  
- **Prompting 기법 호환성:** PAL은 체인오브썰트뿐 아니라 Least-to-Most 기법에도 적용 가능하여 추가적 성능 향상 확인  
- **모델 경량화 활용:** 코드 생성 능력이 충분한 경량 모델에도 적용 시, 상대적 성능 향상 유지  
- **다양한 외부 툴 연동:** 파이썬 외에도 수치 해석 라이브러리∙데이터베이스 쿼리 엔진 등으로 확장 가능  

***

## 향후 연구에의 영향 및 고려 사항  
PAL은 신경망과 심볼릭 인터프리터의 결합으로 AI 추론의 신뢰도를 크게 향상시킨다.  
- **연구 방향:** 다양한 도메인별 DSL(domain-specific language)·정형화된 외부 툴과의 통합 연구  
- **고려 사항:** 코드 생성의 견고성 확보, 실행 환경 최적화, 코드 오탐(incorrect code) 방지 전략 필요  

***

 PAL: Program-aided Language Models (arXiv:2211.10435v2)[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/34e35c5d-6f3d-474f-adcf-01a1448f4164/2211.10435v2.pdf)
