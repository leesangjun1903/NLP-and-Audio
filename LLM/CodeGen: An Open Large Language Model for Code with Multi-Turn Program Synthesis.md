# CodeGen: An Open Large Language Model for Code with Multi-Turn Program Synthesis

## 1. 핵심 주장 및 주요 기여  
**CodeGen** 논문은 자연어 기반 설명만으로도 고품질의 프로그램을 합성할 수 있는 **대규모 언어 모델**을 공개하고, 특히 ‘사용자-모델 간의 대화(turn)로 문제를 단계적으로 분해하여 합성하는 다중-턴 프로그래밍 패러다임’을 제안·검증한다. 주요 기여는 다음과 같다.  
- **대규모 오픈소스 코드 언어 모델**(350M‒16.1B 파라미터)을 훈련·공개  
- **단일-턴 대비 다중-턴** 사용자 명세 방식이 합성 정확도를 크게 향상함을 입증  
- **Multi-Turn Programming Benchmark (MTPB)**: 115개 문제로 구성된 최초의 다중-턴 프로그램 합성 벤치마크 구축  
- 모델·데이터 스케일에 따른 **다중-턴 합성 능력의 출현(emergence)** 정량적 분석  

## 2. 문제 정의 및 제안 기법  
### 2.1 해결하고자 하는 문제  
1) **프로그램 탐색 공간**의 기하급수적 증가  
2) **사용자 의도(specification)**를 자연어로 쉽고 정확히 표현하기 어려움  

### 2.2 모델 구조 및 훈련 데이터  
- **Transformer 기반 자동회귀(decoder-only)** 모델  
- 크기: 350M / 2.7B / 6.1B / 16.1B 파라미터  
- 순차적(pre-train → multi-lingual → Python-only) 데이터  
  - THE PILE: 일반 영어+코드 (31.6B 토큰)  
  - BIGQUERY: 6개 언어 코드(109.6B 토큰)  
  - BIGPYTHON: 파이썬 코드(71.7B 토큰)  

### 2.3 수식  
- **언어 모델링 목표**:  

$$
\mathcal{L}(\theta) = -\sum_{t=1}^T \log P_\theta(x_t \mid x_{ < t})
$$

- **pass@k 평가**: $$n$$ 샘플 중 $$c$$개 성공 시  

$$
\mathrm{pass@k} = 1 - \frac{\binom{n-c}{k}}{\binom{n}{k}}
$$

## 3. 성능 향상  
### 3.1 단일-턴(짧은 프롬프트) HumanEval  
- CODEGEN-MONO 16.1B: pass@1 29.28% → Codex12B(28.81%) 이상[1]

### 3.2 다중-턴(MTPB)  
- CODEGEN-MONO 16.1B: 단일-턴 대비 평균 합성 성공률 +9.26pp, 최대 +12.86pp 향상  
- 모델 크기·코드 데이터 증가에 따라 **다중-턴 합성 능력** 비선형적 향상 확인  
- **큰 모델**(6.1B,16.1B)은 쉬운 문제에서는 단일-턴과 거의 차이 없으나, 중·고난도 문제에서 크게 개선  

## 4. 한계 및 일반화 성능  
- **주의 깊은 프롬프트 작성** 필요: 잘못된 토큰화·문법에 민감  
- 다중-턴 분해가 꼭 유리하지 않은 경우(간단 명세·큰 모델) 존재  
- **일반화**: 자연어 명세와 코드 패턴 간의 노이즈한 연관 학습에 의존 → 도메인·언어 이탈 시 성능 보장 어려움  
- **미구현**: 안전성·버그·취약점 자동 방지 기능 부재  

## 5. 향후 연구에의 영향 및 고려사항  
- **대화형 코드 합성**: 사용자와 상호작용하며 단계적 완성 지원 시스템 개발 촉진  
- **벤치마크 확장**: MTPB를 다양한 도메인(웹, 시스템, 임베디드)과 언어로 확대  
- **해석 가능성 연구**: 다중-턴 합성 과정에서 모델 의사결정 traceability 강화  
- **안전성·정확성**: 합성 코드 검증, 의도 오해 방지, 취약점 탐지 메커니즘 통합  
- **저자원 환경**: 작은 모델에서도 다중-턴 분해로 성능 끌어올리는 방법 모색  

***
CodeGen은 **대규모 언어 모델의 emergent multi-turn 합성 능력**과 **사용자-모델 대화**의 가능성을 최초로 체계적으로 보여주어, 향후 인공지능 기반 프로그래밍 보조 시스템 연구의 중요한 이정표가 될 것이다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/51b7b24d-ba69-4115-bed4-815e23fb2960/2203.13474v5.pdf)
