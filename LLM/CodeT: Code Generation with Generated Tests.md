# CodeT: Code Generation with Generated Tests

## 1. 핵심 주장 및 주요 기여  
**CodeT**는 대형 언어 모델이 생성한 코드 샘플 중 올바른 솔루션을 자동으로 선별하는 문제를 다룬다.  
- **핵심 아이디어**: 코드 솔루션과 함께 자동 생성된 테스트 케이스를 활용해 “이중 실행 합의(dual execution agreement)”를 수행함으로써, 서로 동의(consensus)하는 솔루션 군집(consensus set)을 찾고, 그중 가장 많은 테스트와 솔루션 간 합의를 이루는 군집에서 최적의 코드를 선택한다.  
- **주요 기여**:  
  1. **테스트 케이스 자동 생성**: 프롬프트로 “assert” 구문이 포함된 지시어를 주어, 동일한 언어 모델로부터 다채롭고 까다로운 테스트 케이스를 자동으로 샘플링.  
  2. **이중 실행 합의 알고리즘**: RANSAC에서 영감을 받아 코드 솔루션–테스트 케이스 쌍 간의 합의를 기반으로 군집을 형성하고, 각 군집의 크기(솔루션 수 × 테스트 수)를 점수로 사용해 최적 코드 선택.  
  3. **범용성 및 성능 개선**: Codex, INCODER, CODEGEN 등 다양한 모델과 HumanEval, MBPP, APPS, CodeContests 벤치마크에서 평균 10–20% 이상의 pass@1 성능 향상을 달성.  

## 2. 문제 정의, 제안 방법, 모델 구조, 성능 개선 및 한계  
### 2.1 해결하려는 문제  
사전 학습된 언어 모델은 다수의 코드 샘플을 생성할 수 있으나, 그중 단일 정답(패스하는 코드)을 선별하기 어렵다. 기존 방법은 라벨된 테스트 케이스나 별도 랭커 훈련을 필요로 해 비용과 데이터 의존성이 크다.  

### 2.2 제안 방법  
1. **코드 생성**: 모델 $$M$$에 문맥 $$c$$를 주어 $$N$$개의 코드 샘플 $$\{x_i\}_{i=1}^N$$ 생성.  
2. **테스트 케이스 생성**: 같은 $$M$$에 “pass”와 “assert” 지시어를 추가해 문맥 $$\mathrm{concat}(c,p)$$으로부터 $$M$$개의 테스트 케이스 $$\{y_j\}_{j=1}^M$$ 샘플링.  
3. **기능 합의(consensus) 군집화**: 각 코드 $$x_i$$를 모든 테스트 $$y_j$$에 실행하여 통과 여부를 기록.  
   - 동일한 테스트 집합을 통과하는 코드끼리 군집 $$S_x$$를 형성, 해당 군집이 통과하는 테스트 집합 $$S_y$$ 구성.  
4. **군집 점수**:  

$$
     f(S) = |S_x|\times|S_y|
   $$  
   
가장 높은 $$f(S)$$를 갖는 군집에서 코드를 선택.  

### 2.3 모델 구조  
- 모델 구조 변화 없이, **Codex(code-cushman-001, code-davinci-002)**, **INCODER-6B**, **CODEGEN-MONO-16B**의 **zero-shot** API를 활용.  
- 높은 온도($$\mathrm{temperature}=0.8$$)와 토큰 제약 조건으로 다양성 확보.  

### 2.4 성능 향상  
- **HumanEval pass@1**: 코드-다빈치-002 기준 47.0% → 65.8% (+18.8%)  
- **MBPP pass@1**: 58.1% → 67.7% (+9.6%)  
- APPS·CodeContests 등에서 일관된 성능 향상  
- **테스트 품질 분석**: Codex 테스트는 평균 95% 이상 코드 커버리지 및 낮은 독성 비율(toxicity)로 고품질 확인  
- **미디엄급 모델**에 다빈치-002 테스트 적용 시에도 성능 추가 상승  

### 2.5 한계  
- **계산 비용**: 다수의 코드·테스트 샘플링 및 실행 과정의 오버헤드  
- **실행 가능 코드만 적용**: 컴파일 오류나 외부 의존성 코드는 처리 불가  
- **모델 이해 한계**: 애매하거나 복잡한 문제 설명에서는 잘못된 테스트·코드 합의로 오작동 사례 존재  

## 3. 모델의 일반화 성능 향상 관련 내용  
- **다양한 모델·벤치마크 적용**을 통해 제안 기법이 특정 모델에 한정되지 않고 **범용**으로 동작함을 입증.  
- **테스트 주도 합의**는 라벨 데이터나 별도 튜닝 없이도 모델 간 다양성 차이를 보완하여 **일반화 능력**을 강화.  
- **고품질 테스트 케이스**는 모델 이해도 한계를 일부 완화, 특히 복잡·경쟁형 문제에서도 pass@k 향상에 기여.  
- **샘플 수·테스트 수** 조절로 성능-비용 균형 최적화 가능: 소수 테스트만으로도 높은 성능 달성(10개 테스트만으로 +9.5%↑).  

## 4. 향후 연구 영향 및 고려사항  
- **테스트 케이스 품질 개선**: 모델 자체가 생성한 테스트의 한계를 극복하기 위해 **혼합 학습**이나 **휴리스틱 기반 필터링** 연구 필요.  
- **효율화**: 대규모 샘플·실행 비용을 줄이는 **적응형 샘플링** 또는 **점수 근사** 알고리즘 개발  
- **비실행 코드 지원**: 타입 추론·정적 분석 기반의 테스트 대체 기법 모색  
- **인간-모델 협업**: 사용자가 간단한 지시만 제공해 테스트/코드 생성 과정을 보완하는 **인터랙티브 파이프라인** 설계  
- **공정성·안전성**: 자동 생성 테스트에 내재할 수 있는 악의적·편향적 검증 여부 평가 및 방지  

---  
**결론**: CodeT는 대형 언어 모델의 코드 생성 활용성을 크게 높이는 **자동 테스트 기반 합의 선별** 기법을 제시하며, 범용성·효율성 관점에서 향후 AI 코딩 어시스턴트에 핵심 컴포넌트로 채택될 가능성이 크다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/4f225570-38a5-4dd4-b6fc-ffe4c2087372/2207.10397v2.pdf)
