# Pop2Piano: Pop Audio-based Piano Cover Generation

## 핵심 주장과 주요 기여

Pop2Piano는 팝 음악의 웨이브폼에서 직접 피아노 커버를 생성하는 **최초의 엔드-투-엔드 모델**입니다. 이 연구의 핵심 기여는 다음과 같습니다:

- **300시간 규모의 동기화된 {Pop, Piano Cover} 데이터셋 PSP(Piano Cover Synchronized to Pop Audio) 구축**
- **멜로디나 코드 추출 모듈 없이 스펙트로그램만을 입력으로 사용하는 Transformer 기반 모델 설계**
- **편곡자 토큰을 통한 스타일 제어 기능 구현**

## 해결하고자 하는 문제

### 문제 정의
기존 연구들은 팝 음악을 다른 악기로 편곡할 때 **명시적인 음악 정보 추출 모듈**(멜로디, 코드 추출기)에 의존했습니다. 하지만 피아노 커버 생성은 음악의 분위기나 편곡자의 스타일과 같은 **암묵적 특성**을 포함하므로, 웨이브폼에서 피아노 커버로의 직접 변환이 필요했습니다.

### 데이터 문제
기존에는 대규모 동기화된 {Pop, Piano Cover} 데이터가 없어 데이터 기반 딥러닝 방법론 적용이 어려웠습니다.

## 제안하는 방법

### 1. 데이터셋 구축 파이프라인

**동기화 과정:**
- 피아노 커버 오디오 → MIDI 변환 (피아노 전사 모델 사용)
- SynctoolBox를 이용한 워핑 패스 계산으로 팝 오디오와 정렬
- 8분음표 단위로 시간 양자화

**품질 필터링:**
- 멜로디 크로마 정확도(MCA) < 0.15인 샘플 제거
- 오디오 길이 차이 20% 이상인 샘플 제거

### 2. 모델 구조

**입력:**
- Log-Mel 스펙트로그램 (샘플링 레이트: 22050, 윈도우: 4096, 홉: 1024)
- 편곡자 토큰 (스타일 조건부)

**출력 토큰 체계:**
- **Note Pitch [128개]**: MIDI 피치 (실제로는 피아노 88키 사용)
- **Note On/Off [2개]**: 음표 시작/끝 결정
- **Beat Shift [100개]**: 8분음표 단위 상대적 시간 이동
- **EOS, PAD [2개]**: 시퀀스 종료 및 패딩

**아키텍처:**
- T5-small 기반 Transformer 인코더-디코더 구조
- 약 5,900만개 파라미터
- 상대적 위치 임베딩 사용
- 학습 가능한 편곡자 스타일 임베딩 레이어

### 3. 훈련 설정

**훈련 과정:**
- 무작위로 추출된 4박자 길이 오디오 사용
- PSP 전체 데이터셋에 대해 2000회 반복
- 추정 훈련 데이터: 약 5,500시간
- 최적화: AdaFactor (학습률 0.001)

## 성능 평가 및 향상

### 1. 객관적 평가

**멜로디 크로마 정확도(MCA) 비교:**
- POP909F (인간 제작): 0.395
- PSP (인간 제작): 0.3493  
- Pop2Piano_PSP: **0.402 ± 0.021**

놀랍게도 **명시적 멜로디 추출 없이도 인간이 만든 POP909 데이터셋과 유사한 MCA를 달성**했습니다.

### 2. 주관적 평가

25명 참가자 대상 청취 평가:
- Pop2Piano_PSP가 Pop2Piano_POP909보다 **70% 선호도**
- MOS(Mean Opinion Score): Pop2Piano_PSP (3.216) vs Pop2Piano_POP909 (2.856)
- 통계적 유의성: p = 3.34e-05 (99% 신뢰구간)

### 3. 스타일 제어 검증

편곡자별 음표 밀도 분석에서 **R² = 0.804의 높은 선형성**을 보여, 모델이 지정된 편곡자의 스타일을 성공적으로 반영함을 확인했습니다.

## 일반화 성능 및 한계

### 일반화 성능
- **21명의 서로 다른 편곡자** 데이터로 훈련하여 다양한 스타일 학습
- 동일한 원곡에 대한 **여러 버전의 피아노 커버** 포함으로 스타일 다양성 확보
- 훈련에 포함되지 않은 곡들에 대해서도 **자연스러운 피아노 커버 생성** 가능

### 주요 한계점

1. **제한된 컨텍스트 길이**: 4박자만 고려하여 더 긴 구간에서 멜로디 윤곽이나 반주 텍스처 일관성 부족

2. **리듬적 제약**: 8분음표 기반 양자화로 인해 **3연음표, 16분음표, 트릴** 등 다양한 리듬 패턴 생성 불가

3. **스타일 평가의 주관성**: 편곡 스타일이 암묵적이어서 정량적 평가 방법 제한

## 미래 연구에 대한 영향과 고려사항

### 연구 영향
1. **오디오-투-MIDI 변환 패러다임 확장**: 단순 전사를 넘어 창의적 편곡 영역으로 확장
2. **대규모 음악 데이터 활용 방법론**: 동기화 파이프라인은 다른 음악 변환 태스크에 적용 가능
3. **스타일 조건부 생성 모델**: 편곡자 토큰을 통한 스타일 제어 방법론 제시

### 향후 연구 고려사항

**기술적 개선:**
- **더 긴 컨텍스트** 모델링을 위한 어텐션 메커니즘 개선
- **다양한 리듬 패턴** 지원을 위한 토큰 체계 확장
- **계층적 음악 구조** 이해를 위한 멀티스케일 모델링

**데이터셋 확장:**
- **다양한 장르**와 **문화권** 음악으로 데이터셋 확대
- **실시간 성능** 최적화를 위한 경량화 연구
- **다중 악기 편곡**으로의 확장 가능성 탐구

**평가 방법론:**
- 편곡 품질과 스타일 충실도를 위한 **새로운 평가 메트릭** 개발
- **음악 이론적 분석**을 통한 정량적 평가 방법 고안

이 연구는 AI 기반 음악 생성 분야에서 **창의적 편곡**이라는 새로운 영역을 개척했으며, 향후 개인화된 음악 제작 도구와 음악 교육 플랫폼 발전에 중요한 기여를 할 것으로 예상됩니다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/527d2763-687f-48ac-ace1-056f1d88f26b/2211.00895v2.pdf)
