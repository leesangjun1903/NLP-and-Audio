# Approaches to Natural Language Understanding – Rule-Based Systems, Machine Learning, and Deep Learning
## Rule-based approaches
규칙 기반 접근법의 기본 개념은 언어가 단어의 의미와 어떻게 관련되어 있는지에 대한 규칙을 준수한다는 것입니다.  
예를 들어, 외국어를 배울 때 우리는 일반적으로 단어의 의미, 문장의 순서, 접두사와 접미사가 단어의 의미를 어떻게 변화시키는지에 대한 구체적인 규칙을 배웁니다.  
NLU에 대한 규칙 기반 접근법은 이러한 종류의 규칙을 NLU 시스템에 제공하여 시스템이 사람과 같은 방식으로 문장의 의미를 결정할 수 있다는 전제하에 작동합니다.  
규칙 기반 접근법은 1950년대 중반부터 1990년대 중반까지 NLU에서 널리 사용되어 기계 학습 기반 접근법이 대중화되기 전까지 사용되었습니다.  
그러나 규칙 기반 접근법이 그 자체로 또는 다른 기술과 결합하여 유용한 NLU 문제도 여전히 존재합니다. 언어의 다양한 측면과 관련된 규칙과 데이터를 검토하는 것으로 시작하겠습니다.

### Words and lexicons
언어의 단어 집합을 언어의 어휘(**lexicon**)라고 합니다.  
어휘의 개념은 우리가 사전이라고 생각하는 것, 즉 언어의 단어 목록에 해당합니다.  
계산 어휘에는 각 단어에 대한 다른 정보도 포함됩니다.  
특히 언어의 일부 또는 일부가 포함됩니다. 언어에 따라 단어에 불규칙한 형태(예: 불규칙한 영어 동사 "먹다", 과거 시제 "먹다", 과거 참여자 "먹다" 등)가 있는지 여부에 대한 정보도 포함될 수 있습니다.  
일부 어휘에는 각 단어와 의미가 관련된 단어와 같은 의미 정보도 포함됩니다.

### Part-of-speech tagging
학교에서 가르치는 전통적인 품사에는 "noun", "verb", "adjective", 전치사 등과 같은 범주가 포함됩니다. 계산 어휘에서 사용되는 품사는 전통적인 범주에서 포착할 수 있는 것보다 더 구체적인 정보를 표현해야 하기 때문에 일반적으로 이보다 더 상세합니다.  
예를 들어, 영어의 전통적인 동사 범주는 보통 과거 시제와 과거 분사 형태와 같이 동사의 다양한 형태에 해당하는 여러 가지 품사로 나뉩니다. 영어에서 흔히 사용되는 품사 집합은 펜 트리뱅크(https://catalog.ldc.upenn.edu/LDC99T42) )의 품사입니다. 언어마다 품사 범주의 품사가 다릅니다.

자연어 처리에서 매우 유용한 작업은 텍스트의 단어에 품사를 할당하는 것입니다.  
이를 품사 태깅(**part-of-speech tagging (POS tagging)**)이라고 합니다.  
표 3.1은 "보스턴에서 런던으로 가는 항공편을 예약하고 싶습니다:"라는 문장에 대한 펜 트리뱅크 품사 태깅의 예를 보여줍니다.

<img width="712" alt="스크린샷 2025-05-04 오후 2 57 34" src="https://github.com/user-attachments/assets/936888c6-48e2-4edc-b860-1582b21cb9c5" />

POS 태깅은 많은 단어가 두 개 이상의 품사를 가지고 있기 때문에 사전에서 단어를 찾아 품사로 표시하는 문제가 아닙니다.  
우리의 예제에서 이 중 하나는 예시에서 동사로 사용되지만 일반적으로 명사로도 사용되는 "책"입니다.  
POS 태깅 알고리즘은 올바른 품사를 결정하기 위해 단어 자체를 살펴볼 뿐만 아니라 단어의 문맥도 고려해야 합니다. 이 예제에서 "책"은 종종 다음 단어가 동사임을 나타내는 "to" 뒤에 따릅니다.

### Grammar
문법 규칙은 문장을 이해하고 작성자의 의미를 올바르게 전달할 수 있도록 문장에서 단어의 순서를 설명하는 규칙입니다.  
문장과 그 구성 요소 간의 부분-전체 관계를 설명하는 규칙의 형태로 작성할 수 있습니다.  
예를 들어, 영어의 일반적인 문법 규칙에 따르면 문장은 명사구 뒤에 동사구로 구성됩니다. 모든 자연어에 대한 완전한 계산 문법은 일반적으로 수백 개의 규칙으로 구성되며 매우 복잡합니다.  
이제 문법을 처음부터 구축하는 것은 그리 흔하지 않으며, 오히려 문법은 **자연어 툴킷(NLTK)이나 spacy**와 같은 일반적으로 사용되는 Python NLP 라이브러리에 이미 포함되어 있습니다.

### Parsing
문장의 부분들 간의 관계를 찾는 것을 파싱이라고 합니다.  
이는 특정 문장에 문법 규칙을 적용하여 문장의 부분들이 서로 어떻게 관련되어 있는지를 보여주는 것을 포함합니다.  
그림 3.1은 "항공편을 예약하고 싶습니다"라는 문장의 파싱을 보여줍니다. 의존성 파싱으로 알려진 이러한 파싱 스타일에서는 단어들 간의 관계가 단어들 사이의 호로 표시됩니다.  
예를 들어, 동사 "좋아요"의 주어가 "좋아요"라는 사실은 "좋아요"와 "우리"를 연결하는 "nsubj"(nominal subject, 명사 주어( nsubj)는 절의 통사적 주어이자 원행위자(proto-agent)인 명사입니다. 즉, 주어 여부에 대한 일반적인 문법적 검사를 통과하는 위치에 있으며, 이 논증은 절의 더 행위적인 행위자, 행위자, 또는 원행위자입니다. 이 명사는 명사로 시작될 수도 있고, 대명사나 관계대명사일 수도 있으며, 생략 부호가 있는 문맥에서는 형용사와 같은 다른 것이 될 수도 있습니다.https://universaldependencies.org/en/dep/nsubj.html)라는 호로 표시되어 있습니다.


<img width="828" alt="스크린샷 2025-05-04 오후 2 59 46" src="https://github.com/user-attachments/assets/f062b6f3-6b58-4df0-af05-f10b5d16bc57" />

### Semantic analysis
구문 분석은 문장에서 단어가 서로 구조적으로 어떻게 관련되어 있는지 파악하는 것을 포함하지만, 단어의 의미나 의미가 어떻게 관련되어 있는지에 대해서는 아무것도 언급하지 않습니다.  
이러한 종류의 처리는 의미 분석(**semantic analysis**)을 통해 이루어집니다. 의미 분석에는 다양한 접근 방식이 있지만, 의미 분석을 생각하는 한 가지 방법은 문장의 주 동사로 시작하여 동사와 주어, 직접 목적어 및 관련 전치사구와 같은 문장의 다른 부분 간의 관계를 살펴보는 것입니다.  
예를 들어 그림 3.1의 "좋아요"의 주어는 "우리"입니다. "We"는 "liking"를 경험하는 것으로 설명되기 때문에 "좋아요"의 "experiencer"로 설명할 수 있습니다.  
마찬가지로 "비행기를 예약하는 것"도 "좋아요"의 "환자"로 설명할 수 있습니다. 의미 분석은 규칙을 적용하여 가장 자주 수행되지만 다음 섹션에서 설명하는 것처럼 기계 학습 기법으로도 수행할 수 있습니다.  
문장에서 역할과 무관하게 단어로 표시되는 개념 간의 의미적 관계를 찾는 것도 유용할 수 있습니다.  
예를 들어 "개"를 일종의 "animal"로 생각하거나 "eating"을 일종의 행동으로 생각할 수 있습니다.  
이러한 관계를 찾는 데 유용한 리소스 중 하나는 수천 개의 영어 단어 간의 관계를 설명하는 대규모 수동으로 준비된 데이터베이스인 Wordnet(https://wordnet.princeton.edu/), 입니다.  
그림 3.2는 "airplane" 단어에 대한 Wordnet 정보의 일부를 보여주며, 비행기는 일종의 "항공기"인 일종의 "항공기보다 heavier"라는 매우 일반적인 범주 "entity:"까지 거슬러 올라갑니다.

<img width="551" alt="스크린샷 2025-05-04 오후 3 03 48" src="https://github.com/user-attachments/assets/8a2483c4-2209-45a4-bbc1-20018c1ff098" />

### Pragmatic analysis
실용적 분석(**Pragmatic analysis**)은 문맥에서 단어와 구의 의미를 결정합니다.  
예를 들어 긴 텍스트에서는 같은 단어를 지칭할 때 다른 단어를 사용하거나 같은 단어로 다른 단어를 지칭할 수 있습니다. 이를 핵심 참조(**coreference**)라고 합니다.  
예를 들어 "보스턴에서 런던으로 가는 항공편을 예약하고 싶습니다"라는 문장 뒤에 "오전 10시 이전에 출발해야 하는 항공편"이라는 문장이 이어질 수 있습니다.  
실용적 분석에 따르면 오전 10시 이전에 출발해야 하는 항공편은 예약하려는 항공편과 동일한 항공편입니다. 

실용적 분석의 매우 중요한 유형은 텍스트에서 발생하는 참조를 실제 세계의 해당 엔티티와 연결하는 엔티티 인식(NER)(**named entity recognition (NER)**)이라는 이름입니다.  
그림 3.3은 "유나이티드에서 런던행 항공편을 1,000달러 미만으로 예약하세요"라는 문장의 NER을 보여줍니다. "런던"은 지정된 엔티티로, 지리적 위치(geographical location)로, "유나이티드"는 조직(organization)으로, "1,000달러 미만"은 금전적 금액(monetary amount)으로 표시됩니다:

<img width="709" alt="스크린샷 2025-05-04 오후 3 07 05" src="https://github.com/user-attachments/assets/22090213-c92c-4608-95b4-e60ff88cdc52" />

### Pipelines
NLP 애플리케이션에서는 방금 설명한 단계가 파이프라인으로 구현되는 경우가 가장 많습니다. 즉, 한 단계의 결과가 다음 단계로 입력되는 일련의 단계입니다.

어휘 조회: 애플리케이션 사전에서 단어 찾기  
POS 태깅: 문맥상 각 단어에 음성 부분 할당  
구문 분석: 단어들이 서로 어떻게 관련되어 있는지 확인합니다  
의미 분석: 단어의 의미와 문장의 전체적인 의미를 파악합니다  
실용적 분석: 대명사의 해석과 같이 더 넓은 맥락에 따라 달라지는 의미의 측면을 파악합니다

파이프라인 사용의 한 가지 장점은 다음 단계에서 예상되는 형식의 출력만 있으면 각 단계를 서로 다른 기술로 구현할 수 있다는 것입니다.  
따라서 파이프라인은 규칙 기반 접근 방식뿐만 아니라 다음 섹션에서 설명할 다른 기술에서도 유용합니다. 

## Traditional machine-learning approaches
규칙 기반 접근 방식은 언어에 대한 매우 세분화되고 구체적인 정보를 제공하지만, 이러한 접근 방식에는 몇 가지 단점이 있어 대안 개발에 동기를 부여했습니다.

규칙 기반 접근 방식에서 사용되는 규칙을 개발하는 것은 힘든 과정이 될 수 있습니다.  
규칙 개발은 전문가가 언어에 대한 지식을 바탕으로 규칙을 직접 작성하거나, 더 일반적으로 올바른 분석을 통해 주석이 달린 텍스트의 예제에서 규칙을 도출할 수 있습니다.  
이러한 두 가지 접근 방식 모두 비용이 많이 들고 시간이 많이 소요될 수 있습니다.

규칙은 시스템이 접하는 모든 텍스트에 보편적으로 적용될 가능성은 낮습니다.  
규칙을 개발한 전문가들은 일부 사례를 간과했을 수도 있고, 주석이 달린 데이터에 모든 사례의 예가 포함되지 않을 수도 있으며, 화자는 잘못된 시작과 같은 오류를 범할 수 있으며, 이는 규칙의 적용을 받지 않지만 분석이 필요합니다.  
작성된 언어에는 철자 오류가 포함될 수 있으며, 이로 인해 어휘록에 없는 단어가 나올 수 있습니다.  
마지막으로 언어 자체가 변경되어 기존 규칙에서 다루지 않는 새로운 단어와 새로운 구문이 생성될 수 있습니다.  

이러한 이유로 규칙 기반 접근 방식은 주로 NLU 파이프라인의 일부로 사용되며, 다른 기술을 보완합니다.

### Representing documents
문서의 표현은 단어를 기반으로 합니다. 매우 간단한 접근 방식은 문서가 포함된 단어 집합으로 간단히 표현되어야 한다고 가정하는 것입니다.  
이를 **bag of words (BoW)** 접근 방식이라고 합니다.  
문서 표현을 위해 BoW를 사용하는 가장 간단한 방법은 말뭉치에 있는 모든 단어의 목록을 작성하고, 각 문서와 각 단어에 대해 해당 단어가 해당 문서에서 발생하는지 여부를 명시하는 것입니다.

이 장난감 말뭉치의 전체 어휘는 29개의 단어로 구성되어 있으므로 각 문서에는 문서에 나타나는지 여부를 나타내는 29개의 항목이 나열되어 있습니다. 이 목록은 표 3.2에 표시된 것처럼 1로 표시되며 0으로 표시되지 않습니다:

<img width="787" alt="스크린샷 2025-05-07 오후 3 30 59" src="https://github.com/user-attachments/assets/9888bfa9-6ebb-468a-918c-ba6eb0fa70e5" />

<img width="787" alt="스크린샷 2025-05-07 오후 3 31 09" src="https://github.com/user-attachments/assets/1d6c774a-eb38-4dea-822e-153525973437" />

### Classification
BoW 접근 방식의 가정은 두 문서의 공통 단어가 많을수록 의미가 더 유사하다는 것입니다. 이는 어렵고 빠른 규칙은 아니지만 실제로는 유용한 것으로 밝혀졌습니다.  
많은 응용 분야에서 의미가 비슷한 문서를 다른 범주로 그룹화하고자 합니다. 이것이 바로 분류 과정입니다.  
새 문서를 이러한 범주 중 하나로 분류하려면 각 범주에 있는 다른 문서의 벡터와 그 벡터가 얼마나 유사한지 알아내야 합니다. 

## Deep learning approaches
신경망의 기본 개념은 동물 신경계의 뉴런과 유사하게 뉴런이라고 하는 연결된 단위의 층으로 구성된다는 것입니다.  
신경망의 각 뉴런은 신경망의 다른 뉴런에 연결되어 있습니다. 뉴런이 다른 뉴런으로부터 적절한 입력을 받으면 다른 뉴런으로 발화하거나 입력을 보내 다른 뉴런이 수신하는 다른 입력에 따라 발화 여부를 결정합니다.  
학습 과정에서 뉴런의 가중치는 분류 정확도를 극대화하도록 조정됩니다. 

현재 신경망의 인기는 특히 충분한 학습 데이터를 고려할 때 이전 접근 방식보다 더 정확한 경우가 많기 때문입니다.  
그러나 대규모 작업을 위해 신경망을 훈련하는 과정은 복잡하고 시간이 많이 소요될 수 있으며 전문 데이터 과학자의 서비스가 필요할 수 있습니다.  
경우에 따라 신경망이 제공하는 추가 정확도만으로는 시스템 개발에 드는 추가 비용을 정당화하기에 충분하지 않습니다.

## Pre-trained models
가장 최근의 NLU 접근 방식은 자연어를 이해하는 데 필요한 많은 정보를 인터넷 텍스트와 같은 일반 텍스트를 처리하여 언어의 기본 모델을 생성함으로써 다양한 응용 프로그램에 제공할 수 있다는 아이디어에 기반하고 있습니다.  
이러한 모델 중 일부는 매우 크고 방대한 양의 데이터를 기반으로 합니다.  
이러한 모델을 특정 응용 프로그램에 적용하기 위해, 일반 모델은 응용 프로그램별 학습 데이터를 사용하여 미세 조정, **fine-tuning**이라는 과정을 통해 응용 프로그램에 적응됩니다.  
기본 모델에는 이미 언어에 대한 방대한 양의 일반 정보가 포함되어 있기 때문에, 일부 전통적인 접근 방식에 필요한 학습 데이터보다 학습 데이터의 양이 상당히 적을 수 있습니다. 이러한 인기 있는 기술에는 BERT와 그 다양한 변형 및 생성적 사전 학습 트랜스포머(GPT, **Generative Pre-trained Transformers (GPTs)**)와 그 변형이 포함됩니다.

## Considerations for selecting technologies
특정 문제를 해결하기 위해 어떤 기술이나 기술을 사용해야 하는지 어떻게 결정해야 하나요? 이러한 고려 사항은 대체로 실용적이며 작업 솔루션을 만드는 데 필요한 비용과 노력과 관련이 있습니다.

<img width="845" alt="스크린샷 2025-05-07 오후 3 37 45" src="https://github.com/user-attachments/assets/b44f79c3-4687-4bdf-9243-7eca58d4f191" />

<img width="835" alt="스크린샷 2025-05-07 오후 3 38 01" src="https://github.com/user-attachments/assets/2d1fdd1e-bd06-4f32-9340-12512c18a3aa" />

표 3.3은 이 장에서 검토한 네 가지 NLU 접근 방식과 개발자 전문성, 필요한 데이터 양, 학습 시간, 정확성 및 비용과 어떻게 비교하는지를 보여줍니다.  
표 3.3에서 볼 수 있듯이 모든 접근 방식에는 장단점이 있습니다.  
대량의 데이터가 필요하지 않은 작거나 간단한 문제의 경우 적어도 파이프라인의 일부에 대해서는 규칙 기반, 딥러닝 또는 사전 학습된 접근 방식을 강력하게 고려해야 합니다.  
사전 학습된 모델은 정확하고 개발 비용이 상대적으로 낮지만, 개발자는 클라우드 서비스 비용이나 로컬 컴퓨터 리소스에서 대규모 모델을 관리하는 데 드는 비용을 피하는 것을 선호할 수 있습니다:

가장 중요한 고려 사항은 해결 중인 문제와 허용 가능한 비용입니다. 또한 주석이 달린 데이터에 의존하는 접근 방식의 경우 두 가지 이상의 접근 방식에 사용할 수 있는 기술을 선택하는 것이 영구적인 약속이 아니라는 점도 명심해야 합니다.
