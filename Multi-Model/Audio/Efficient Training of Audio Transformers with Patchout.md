# Efficient Training of Audio Transformers with Patchout

## 핵심 주장 및 주요 기여
**Efficient Training of Audio Transformers with Patchout** 논문은 오디오 스펙트로그램을 입력으로 하는 트랜스포머 모델의 계산 복잡도와 메모리 요구량을 획기적으로 줄이면서도 성능을 향상시키는 **Patchout** 기법을 제안한다.  
주요 기여는 다음과 같다.  
- Patchout 기법 도입: 학습 중 입력 패치를 임의로 제거하여 시퀀스 길이를 줄이고, 이는 계산·메모리 비용 절감과 정규화 효과를 동시에 제공.  
- 시간·주파수 위치 인코딩 분리: 각 차원별 위치 인코딩을 분리하여 다양한 길이의 오디오 클립에 유연하게 대응.  
- 복합적인 경량화 전략: 패치 오버랩 제거, 트랜스포머 깊이 축소 기법을 결합해 CNN 대비 속도·메모리 우위를 확보.  

## 문제 정의 및 해결 방법
### 1. 해결하고자 하는 문제  
트랜스포머의 자기-어텐션 연산은 입력 시퀀스 길이 $$n$$에 대해 $$O(n^2)$$ 복잡도를 가지므로, 스펙트로그램 패치 길이가 길어질수록 계산 및 메모리 부담이 급격히 증가한다.

### 2. 제안 기법: Patchout  
Patchout은 학습 시 입력 시퀀스에서 일부 패치를 무작위로 제거(drop)하여 시퀀스 길이 $$n$$을 줄이는 방식이다.  
- **Unstructured Patchout (PaSST-U)**: 패치 위치 무관하게 임의 제거.  
- **Structured Patchout (PaSST-S)**: 주파수 또는 시간 방향으로 연속된 열(row) 또는 행(column) 단위로 제거.  

수식으로, 입력 시퀀스 $$X \in \mathbb{R}^{n \times d}$$ 에서 제거 비율 $$\rho$$만큼의 인덱스 집합 $$S \subset \{1,\dots,n\}$$를 샘플링하고  

$$
\tilde{X} = X_{\{1,\dots,n\}\setminus S}
$$

를 트랜스포머에 입력한다. 학습 후 추론에서는 전체 시퀀스를 사용한다.

### 3. 모델 구조  
1) 스펙트로그램을 겹치도록 패치 분할 및 선형 투영  
2) **주파수·시간 위치 인코딩** 분리 추가  
3) Patchout 적용  
4) 클래스 토큰 삽입 후 $$d$$개의 셀프-어텐션 블록 통과  
5) 출력 토큰 평균 → 분류기  

추가 경량화:  
- **No-overlap (PaSST-N)**: 패치 겹침 제거  
- **Shallow (PaSST-L)**: 셀프-어텐션 블록 수 절반으로 축소  

## 성능 향상 및 한계
### 성능  
- **Audioset 태깅**: PaSST-S (.471 mAP)로 AST(.459 mAP) 대비 향상, GPU 메모리 50%↓, 속도 3.8×↑.  
- **다운스트림 태스크**: OpenMIC, ESC50, DCASE20, FSD50K에서도 PaSST 전 모델이 CNN 및 기존 트랜스포머 대비 최고 성능·학습 속도 달성.  

### 한계  
- Patchout 비율 및 구조 설정에 따른 최적화 필요.  
- 극단적 제거 시 정보 손실 가능성.  
- 추론 시 전체 시퀀스 사용으로 학습 대비 효율 이점이 반감될 수 있음.  

## 일반화 성능 향상
Patchout은 입력 시퀀스를 불완전하게 학습시킴으로써 모델이 다양한 부분적 정보만으로도 특징을 학습하도록 유도한다. 이는 과적합을 방지하고, 특히 데이터가 제한적인 다운스트림 태스크에서 강한 **정규화 효과**를 보여준다. Structured Patchout(-S)이 Unstructured보다 더 일관된 성능 향상을 나타내며, 패치 단위의 연속 제거가 국소적 특징 학습을 돕는다.

## 향후 연구에 미치는 영향 및 고려사항
- **효율적 트랜스포머 설계**: Patchout 개념을 비전·언어 모델에도 확장 가능.  
- **동적 제거 스케줄링**: 학습 단계별 최적 제거 비율 자동 조정 연구.  
- **추론 최적화**: 학습의 효율 이점을 추론 시에도 활용하는 경량 어텐션 메커니즘 개발.  
- **다중 모달 통합**: 오디오-비전 융합 모델에서 Patchout 기반 정규화 실험.  

Patchout은 계산·메모리 효율과 강력한 정규화를 동시에 제공하는 혁신적 기법으로, 오디오 트랜스포머뿐 아니라 다양한 분야의 대규모 시퀀스 모델링 연구에 새로운 방향을 제시한다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/7da0c7f5-7039-4a94-9777-6780a04b3583/2110.05069v3.pdf
